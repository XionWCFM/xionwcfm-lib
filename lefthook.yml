commit-msg:
  commands:
    lint-commit-msg:
      run: |
        npx commitlint --edit || {
          echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ê°€ í˜•ì‹ì— ë§ì§€ ì•Šì•„ìš”"
          echo ""
          echo "ğŸ” Conventinal Commits Docs"
          echo "https://www.conventionalcommits.org/ko/v1.0.0"
          echo ""
          echo "Conventional Commit ê·œì¹™ì— ë§ê²Œ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”."
          echo ""
          echo "âœ… Examples:"
          echo "  feat: ~~ê¸°ëŠ¥ì„ ê°œë°œí–ˆì–´ìš”"
          echo "  fix: ~~ë²„ê·¸ë¥¼ ê³ ì³¤ì–´ìš”"
          echo "  docs: ë¬¸ì„œë¥¼ ìˆ˜ì •í–ˆì–´ìš”"
          echo "  style: ì½”ë“œ í¬ë§·ì„ ë³€ê²½í–ˆì–´ìš”"
          echo "  refactor: ê¸°ëŠ¥ ë³€ê²½ì„ í•˜ì§€ ì•Šê³  ì½”ë“œë¥¼ ê°œì„ í–ˆì–´ìš”"
          echo ""
          echo "ğŸ‘€ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜µì…˜ì´ì—ìš”:"
          echo "  feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
          exit 1
        }
        
pre-push:
  parallel: true
  commands:
    branch-protection:
      run: |
        branch=$(git rev-parse --abbrev-ref HEAD)
        protected_branches=("main" "dev")

        for protected in "${protected_branches[@]}"; do
          if [[ "$branch" == "$protected" ]]; then
            echo "âŒ Direct push to '$branch' branch is not allowed."
            echo "   Please create a pull request instead."
            exit 1
          fi
        done
    test:
      run: pnpm run test:ci
    format:
      run: |
        pnpm run check:biome
        if ! git diff --exit-code; then
          git add .
          git commit -m 'format code by biome'
        fi
      stage_fixed: true
